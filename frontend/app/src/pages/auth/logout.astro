---
import { getLangFromUrl, useTranslatedPath } from '@i18n/utils';

const lang = getLangFromUrl(Astro.url);
const translatePath = useTranslatedPath(lang);

Astro.cookies.delete('auth_token', { path: '/' })
Astro.cookies.delete('avatar', { path: '/' })
Astro.cookies.delete('primary_pilot', { path: '/' })
Astro.cookies.delete('subscription_id', { path: '/' })

const redirect = translatePath('/')
---

<script define:vars={{ redirect }}>
    navigator.serviceWorker.getRegistrations().then(registrations => {
        for (const registration of registrations) {
            registration.unregister()
        } 
    })

    window.location.href = redirect
</script>