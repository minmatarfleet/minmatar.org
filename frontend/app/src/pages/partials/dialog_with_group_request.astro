---
import { getLangFromUrl, useTranslations } from '@i18n/utils';

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

import type { GroupRequestAction, GroupItemType } from '@dtypes/layout_components'

import Flexblock from '@components/compositions/Flexblock.astro';
import GroupRequestBadge from '@components/blocks/GroupRequestBadge.astro';

const character_id = parseInt(Astro.url.searchParams.get('character_id'))
const character_name = Astro.url.searchParams.get('character_name')
const group_id = parseInt(Astro.url.searchParams.get('group_id'))
const group_name = Astro.url.searchParams.get('group_name')
const group_image = JSON.parse(Astro.url.searchParams.get('group_image'))
const group_description = Astro.url.searchParams.get('group_description')
const corporation_id = parseInt(Astro.url.searchParams.get('corporation_id'))
const corporation_name = Astro.url.searchParams.get('corporation_name')
const type = Astro.url.searchParams.get('type') as GroupRequestAction
const group_type = Astro.url.searchParams.get('group_type') as GroupItemType
const message = Astro.url.searchParams.get('message')
---

<Flexblock>
    <p set:html={message} />
    <GroupRequestBadge
        character={{
            character_id: character_id,
            character_name: character_name,
            corporation: {
                id: corporation_id,
                name: corporation_name
            }
        }}
        type={type}
        group_type={group_type}
        group={{
            id: group_id,
            name: group_name,
            image_url: group_image,
            description: group_description
        }}
    />
</Flexblock>