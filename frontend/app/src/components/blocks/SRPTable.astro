---
import { i18n } from '@helpers/i18n'
const { t } = i18n(Astro.url)

import type { SRPUI } from '@dtypes/layout_components'

interface Props {
    fleet_id:           number;
    fleet_srps:         SRPUI[];
    readonly:           boolean;
    [propName: string]: any;
}

const {
    fleet_id,
    fleet_srps,
    readonly,
    ...attributes
} = Astro.props

import Flexblock from '@components/compositions/Flexblock.astro';
import FlexInline from '@components/compositions/FlexInline.astro';

import SubmitSRPButton from '@components/blocks/SubmitSRPButton.astro';
import SRPItem from '@components/blocks/SRPItem.astro';
---

<Flexblock 
    {...attributes}
    class="[ w-full ]"
    gap='var(--space-m)'
    id="srp-table"
>
    <FlexInline justification='space-between'>
        <FlexInline>
            <Flexblock gap='var(--space-3xs)'>
                <h2>{t('ship_replacement_program')}</h2>
                <small>{fleet_srps.length} {fleet_srps.length !== 1 ? t('pending_ships') : t('pending_ship')}</small>
            </Flexblock>
        </FlexInline>
        <SubmitSRPButton fleet_id={fleet_id} />
    </FlexInline>
    <Flexblock gap='var(--space-3xs)'>
        {fleet_srps.length === 0 && t('no_pending_srp') }
        {fleet_srps.map(srp =>
            <SRPItem srp={srp} readonly={readonly} />
        )}
    </Flexblock>
</Flexblock>