---
import { i18n } from '@helpers/i18n'
const { t } = i18n(Astro.url)

import type { GroupRequestListUI, Alert, GroupItemType } from '@dtypes/layout_components'

interface Props {
    group_requests:     GroupRequestListUI;
    alert?:             Alert | false;
    group_type:         GroupItemType;
}

const {
    group_requests,
    alert = false,
    group_type,
} = Astro.props

import Flexblock from '@components/compositions/Flexblock.astro';

import GroupRequestItem from '@components/blocks/GroupRequestItem.astro';
import GroupItem from '@components/blocks/GroupItem.astro';
import ComponentBlock from '@components/blocks/ComponentBlock.astro';
---
<ComponentBlock
    id={`group-request-list-${group_requests.group_id}`}
    width='narrow'
    x-data={`{
        group_request_list_init() {
            ${alert !== false ? `show_alert_dialog(${JSON.stringify(alert)})` : ''}
        }
    }`}
    x-init="group_request_list_init()"
>
    <Flexblock gap='var(--component-block-gap)'>
        <GroupItem
            group={{
                id: group_requests.group_id,
                name: group_requests.group_name,
                image_url: group_requests.group_image,
                description: `${group_requests.requests.length} ${group_requests.requests.length == 1 ? t('pending_request') : t('pending_requests')}`
            }}
            type={group_type}
        />

        {group_requests.requests.length > 0 &&
            <Flexblock
                gap='var(--space-3xs)'
                class="[ min-h-[64px] !justify-center ]"
            >
                {group_requests.requests.map( (group_request) => 
                    <GroupRequestItem
                        group_request={group_request} 
                        group_type={group_type}
                    />
                )}
            </Flexblock>
        }
    </Flexblock>
</ComponentBlock>