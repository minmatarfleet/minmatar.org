---
import { i18n } from '@helpers/i18n'
const { t, translatePath } = i18n(Astro.url)

interface Props {
    href?:              string;
    external?:          boolean;
    [propName: string]: any;
}

const {
    href,
    external = false,
    ...attributes
} = Astro.props;

const x_data = attributes['x-data'] ?? ''
const x_data_elements = x_data ? x_data.slice(1, -1) : ''
const x_on = attributes['x-on:click.prevent'] ?? undefined

const Element = href ? 'a' : 'button';
---

<Element
    href={ href }
    {...attributes}
    rel={external ? 'nofollow noopener noreferrer' : undefined }
    x-data={external ? `{
        hide_external_link_disclaimer: $persist(false),
        show_external_link_disclaimer() {
            show_alert_dialog({
                title: '${t('leaving_website')}',
                partial: '${translatePath('/partials/external_link_disclaimer_dialog/')}',
            }).then(accepted => {
                if (accepted) window.open('${href}', '_blank')
            })
        },
        ${x_data_elements}
    }` : `{
        ${x_data_elements}
    }`}
    x-on:click.prevent={external ?
        `hide_external_link_disclaimer ? window.open('${href}', '_blank') : show_external_link_disclaimer()` :
        x_on
    }
>
    <slot />
</Element>

<style lang="scss">
    a,
    button {
        border: none;
        padding: 0;
        text-align: left;
        background-color: transparent;
        color: inherit;
        cursor: pointer;
    }
</style>